<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>High-level Estimator Interface to TensorFlow in R • tfestimators</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<script src="extra.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">tfestimators</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Using

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Getting Started</li>
    <li>
      <a href="articles/estimator_basics.html">Estimator Basics</a>
    </li>
    <li>
      <a href="articles/input_functions.html">Input Functions</a>
    </li>
    <li>
      <a href="articles/feature_columns.html">Feature Columns</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced</li>
    <li>
      <a href="articles/run_hooks.html">Run Hooks</a>
    </li>
    <li>
      <a href="articles/creating_estimators.html">Custom Estimators</a>
    </li>
    <li>
      <a href="articles/simplify_function.html">Simplify Function</a>
    </li>
    <li>
      <a href="articles/layers.html">TensorFlow Layers</a>
    </li>
    <li>
      <a href="articles/tensorboard.html">TensorBoard Visualization</a>
    </li>
    <li>
      <a href="articles/parsing_spec.html">Parsing Utilities</a>
    </li>
  </ul>
</li>
<li>
  <a href="articles/examples/index.html">Examples</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/tfestimators">
    <span class="fa fa-github"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->


      </header><div class="row">
  <div class="col-md-9">




<div class="contents">
<div id="r-interface-to-tensorflow-estimators" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#r-interface-to-tensorflow-estimators" class="anchor"></a>R Interface to TensorFlow Estimators</h1></div>
<div id="build-status">

</div>
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p><img src="articles/images/tensorflow-architecture.png" align="right" width="50%" style="margin-left: 15px;"></p>
<p>The <strong>tfestimators</strong> package is an R interface to TensorFlow Estimators, a high-level API that provides:</p>
<ul>
<li><p>Implementations of many different model types including linear models and deep neural networks. More models are coming soon such as state saving recurrent neural networks, dynamic recurrent neural networks, support vector machines, random forest, KMeans clustering, etc.</p></li>
<li><p>A flexible framework for defining arbitrary new model types as custom estimators.</p></li>
</ul>
<p><br></p>
<p>The following canned estimators are currently available:</p>
<table class="table">
<thead><tr class="header">
<th>Estimator</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="reference/linear_estimators.html">linear_regressor()</a></code></td>
<td>Linear regressor model.</td>
</tr>
<tr class="even">
<td><code><a href="reference/linear_estimators.html">linear_classifier()</a></code></td>
<td>Linear classifier model.</td>
</tr>
<tr class="odd">
<td><code><a href="reference/dnn_estimators.html">dnn_regressor()</a></code></td>
<td>DNN Regression.</td>
</tr>
<tr class="even">
<td><code><a href="reference/dnn_estimators.html">dnn_classifier()</a></code></td>
<td>DNN Classification.</td>
</tr>
<tr class="odd">
<td><code><a href="reference/dnn_linear_combined_estimators.html">dnn_linear_combined_regressor()</a></code></td>
<td>DNN Linear Combined Regression.</td>
</tr>
<tr class="even">
<td><code><a href="reference/dnn_linear_combined_estimators.html">dnn_linear_combined_classifier()</a></code></td>
<td>DNN Linear Combined Classification.</td>
</tr>
</tbody>
</table>
<p>For more details on the architecture and design of TensorFlow Estimators, please see the white paper: <a href="http://terrytangyuan.github.io/data/papers/tf-estimators-kdd-paper.pdf">TensorFlow Estimators: Managing Simplicity vs. Flexibility in High-Level Machine Learning Frameworks</a>.</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>To use <strong>tfestimators</strong>, you need to install both the R package as well as <a href="https://tensorflow.rstudio.com/">TensorFlow</a> itself.</p>
<p>First, install the tfestimators R package as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"rstudio/tfestimators"</span>)</code></pre></div>
<p>Then, use the <code><a href="http://www.rdocumentation.org/packages/tensorflow/topics/install_tensorflow">install_tensorflow()</a></code> function to install TensorFlow (note that the current tfestimators package requires version 1.3.0 of TensorFlow so even if you already have TensorFlow installed you should update if you are running a previous version):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/tensorflow/topics/install_tensorflow">install_tensorflow</a></span>()</code></pre></div>
<p>This will provide you with a default installation of TensorFlow suitable for getting started. See the <a href="https://tensorflow.rstudio.com/installation.html">article on installation</a> to learn about more advanced options, including installing a version of TensorFlow that takes advantage of NVIDIA GPUs if you have the correct CUDA libraries installed.</p>
</div>
<div id="simple-example" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-example" class="anchor"></a>Simple Example</h3>
<p>Let’s create a simple linear regression model with the <code>mtcars</code> dataset to demonstrate the use of estimators. We’ll illustrate how ‘input functions’ can be constructed and used to feed data to an estimator, how ‘feature columns’ can be used to specify a set of transformations to apply to input data, and how these pieces come together in the Estimator interface.</p>
<div id="input-function" class="section level4">
<h4 class="hasAnchor">
<a href="#input-function" class="anchor"></a>Input Function</h4>
<p>Estimators can accept data from arbitrary data sources through an ‘input function’. The input function selects feature and response columns from the input source as well as defines how data will be drawn (e.g. batch size, epochs, etc.). The <strong>tfestimators</strong> package provides the <code><a href="reference/input_fn.html">input_fn()</a></code> helper function for generating input functions from common R data structures, e.g. R matrices and data frames.</p>
<p>Here, we define a helper function that will return an input function for a subset of our <code>mtcars</code> data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tfestimators)

<span class="co"># return an input_fn for a given subset of data</span>
mtcars_input_fn &lt;-<span class="st"> </span><span class="cf">function</span>(data) {
  <span class="kw"><a href="reference/input_fn.html">input_fn</a></span>(data,
           <span class="dt">features =</span> <span class="kw">c</span>(<span class="st">"disp"</span>, <span class="st">"cyl"</span>),
           <span class="dt">response =</span> <span class="st">"mpg"</span>,
           <span class="dt">batch_size =</span> <span class="dv">32</span>,
           <span class="dt">num_epochs =</span> <span class="dv">10</span>)
}</code></pre></div>
</div>
<div id="feature-columns" class="section level4">
<h4 class="hasAnchor">
<a href="#feature-columns" class="anchor"></a>Feature Columns</h4>
<p>Next, we define the feature columns for our model. Feature columns are mappings of raw input data to the data that we’ll actually feed into our training, evaluation, and prediction steps. Here, we create a list of feature columns containing the <code>disp</code> and <code>cyl</code> variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cols &lt;-<span class="st"> </span><span class="kw"><a href="reference/feature_columns.html">feature_columns</a></span>(
  <span class="kw"><a href="reference/column_numeric.html">column_numeric</a></span>(<span class="st">"disp"</span>),
  <span class="kw"><a href="reference/column_numeric.html">column_numeric</a></span>(<span class="st">"cyl"</span>)
)</code></pre></div>
<p>You can also define multiple feature columns at once:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cols &lt;-<span class="st"> </span><span class="kw"><a href="reference/feature_columns.html">feature_columns</a></span>(
  <span class="kw"><a href="reference/column_numeric.html">column_numeric</a></span>(<span class="st">"disp"</span>, <span class="st">"cyl"</span>)
)</code></pre></div>
<p>By using the family of <a href="reference/index.html#section-feature-columns">feature column functions</a> we can define various transformations on the data before using it for modeling.</p>
</div>
<div id="estimator" class="section level4">
<h4 class="hasAnchor">
<a href="#estimator" class="anchor"></a>Estimator</h4>
<p>Next, we create the estimator by calling the <code><a href="reference/linear_estimators.html">linear_regressor()</a></code> function and passing it a set of feature columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model &lt;-<span class="st"> </span><span class="kw"><a href="reference/linear_estimators.html">linear_regressor</a></span>(<span class="dt">feature_columns =</span> cols)</code></pre></div>
</div>
<div id="training" class="section level4">
<h4 class="hasAnchor">
<a href="#training" class="anchor"></a>Training</h4>
<p>We’re now ready to train our model, using the <code><a href="http://www.rdocumentation.org/packages/tensorflow/topics/train">train()</a></code> function. We’ll partition the <code>mtcars</code> data set into separate training and validation data sets, and feed the training data set into <code><a href="http://www.rdocumentation.org/packages/tensorflow/topics/train">train()</a></code>. We’ll hold 20% of the data aside for validation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">indices &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">size =</span> <span class="fl">0.80</span> <span class="op">*</span><span class="st"> </span><span class="kw">nrow</span>(mtcars))
train &lt;-<span class="st"> </span>mtcars[indices, ]
test  &lt;-<span class="st"> </span>mtcars[<span class="op">-</span>indices, ]

<span class="co"># train the model</span>
model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tensorflow/topics/train">train</a></span>(<span class="kw">mtcars_input_fn</span>(train))</code></pre></div>
</div>
<div id="evaluation" class="section level4">
<h4 class="hasAnchor">
<a href="#evaluation" class="anchor"></a>Evaluation</h4>
<p>We can evaluate the model’s accuracy using the <code><a href="http://www.rdocumentation.org/packages/tensorflow/topics/evaluate">evaluate()</a></code> function, using our ‘test’ data set for validation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tensorflow/topics/evaluate">evaluate</a></span>(<span class="kw">mtcars_input_fn</span>(test))</code></pre></div>
</div>
<div id="prediction" class="section level4">
<h4 class="hasAnchor">
<a href="#prediction" class="anchor"></a>Prediction</h4>
<p>After we’ve finished training out model, we can use it to generate predictions from new data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">obs &lt;-<span class="st"> </span>mtcars[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, ]
model <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">predict</span>(<span class="kw">mtcars_input_fn</span>(obs))</code></pre></div>
</div>
</div>
</div>
<div id="learning-more" class="section level2">
<h2 class="hasAnchor">
<a href="#learning-more" class="anchor"></a>Learning More</h2>
<p>These articles cover the basics of using TensorFlow Estimators:</p>
<ul>
<li><a href="articles/estimator_basics.html">Estimator Basics</a></li>
<li><a href="articles/input_functions.html">Input Functions</a></li>
<li><a href="articles/feature_columns.html">Feature Columns</a></li>
</ul>
<!--
These articles provide in depth documentation and example uses of canned estimators:

- [Linear Models](articles/linear_estimators.html)
- [Linear/DNN Models](articles/linear_dnn_combined_estimators.html)
- [Support Vector Machines](articles/support_vector_machines.html)
- [Recurrent Neural Networks](articles/recurrent_neural_networks.html)
--><p>These articles describe more advanced topics/usage:</p>
<ul>
<li>
<a href="articles/run_hooks.html">Run Hooks</a> <!--
- [Run Configuration](articles/run_configuration.html)
- [Experiments](articles/experiments.html)
-->
</li>
<li><a href="articles/creating_estimators.html">Custom Estimators</a></li>
<li><a href="articles/layers.html">TensorFlow Layers</a></li>
<li><a href="articles/tensorboard.html">TensorBoard Visualization</a></li>
<li><a href="articles/parsing_spec.html">Parsing Utilities</a></li>
</ul>
<p>One of the best ways to learn is from reviewing and experimenting with examples. See the <a href="articles/examples/index.html">Examples</a> page for a variety of examples to help you get started.</p>
<!--
When you have built your model and are ready to deploy it, see the [Deployment](articles/deployment.html) page for an in-depth review of deployment options.
-->
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/rstudio/tfestimators">https://​github.com/​rstudio/​tfestimators</a>
</li>
<li>Report a bug at <br><a href="https://github.com/rstudio/tfestimators/issues">https://​github.com/​rstudio/​tfestimators/​issues</a>
</li>
</ul>
<h2>License</h2>
<p>Apache License 2.0</p>
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing tfestimators</a></li>
</ul>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Yuan Tang <br><small class="roles"> Author, maintainer </small> </li>
<li>JJ Allaire <br><small class="roles"> Author </small> </li>
<li>Kevin Ushey <br><small class="roles"> Author </small> </li>
<li>
<a href="https://www.rstudio.com"><img src="http://tidyverse.org/rstudio-logo.svg" height="24"></a> <br><small class="roles"> Copyright holder, funder </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/rstudio/tfestimators.svg"><img src="https://travis-ci.org/rstudio/tfestimators.svg?branch=main" alt="Travis-CI Build Status"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Yuan Tang, JJ Allaire, Kevin Ushey, <a href="https://www.rstudio.com"><img src="http://tidyverse.org/rstudio-logo.svg" height="24"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
